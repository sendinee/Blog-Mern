{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\zoema\\\\blog\\\\front-react\\\\src\\\\component\\\\FormPost.js\";\nimport React from 'react';\nimport { updateRessource, createRessource, deleteRessource, getRessources } from '../services/api_services';\nimport RichTextEditor from 'react-rte';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class FormPost extends React.Component {\n  constructor(props) {\n    super(props);\n\n    if (props.data) {\n      this.state = Object.assign({\n        image: null,\n        categories: [],\n        category: null\n      }, props.data);\n      this.state.contenu = RichTextEditor.createValueFromString(this.state.contenu, \"html\");\n    } else {\n      this.state = {\n        title: \"\",\n        title_description: \"\",\n        categories: [],\n        category: null,\n        contenu: RichTextEditor.createEmptyValue(),\n        image: null\n      };\n    }\n  }\n\n  componentDidMount() {\n    getRessources(\"category\").then(result => {\n      this.setState({\n        categories: result\n      });\n    });\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    if (nextProps.data && this.props.data != nextProps.data) {\n      Object.assign(nextState, nextProps.data);\n    }\n\n    return true;\n  }\n\n  onChange(e) {\n    this.setState({\n      [e.target.name]: e.target.value\n    });\n  }\n\n  handleFileChange(event) {\n    const {\n      target\n    } = event;\n    const {\n      files\n    } = target;\n\n    if (files && files[0]) {\n      var reader = new FileReader();\n\n      reader.onload = event => {\n        this.setState({\n          image: event.target.result\n        });\n      };\n\n      reader.readAsDataURL(files[0]);\n    }\n  }\n\n  save(e) {\n    e.preventDefault();\n    let postData = Object.assign({}, this.state);\n    postData.contenu = postData.contenu.toString('html');\n\n    if (this.props.data) {\n      delete postData.__v;\n      delete postData._id;\n      postData.updated = new Date();\n      updateRessource(\"post\", this.props.data._id, postData).then(result => {\n        alert(\"Enregistrement éffectué.\");\n        this.props.refresh();\n      });\n    } else {\n      createRessource(\"post\", postData).then(result => {\n        alert(\"Enregistrement éffectué.\");\n        this.props.refresh();\n        this.props.onHide();\n      });\n    }\n  }\n\n  cancel(e) {\n    e.preventDefault();\n    this.props.onHide();\n  }\n\n  delete(e) {\n    e.preventDefault();\n    deleteRessource(\"post\", this.props.data._id).then(result => {\n      alert(\"Suppréssion éffectué.\");\n      this.props.refresh();\n      this.props.onHide();\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"form\", {\n      style: {\n        flexDirection: \"row\",\n        display: \"flex\",\n        padding: 10,\n        flex: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flexDirection: \"column\",\n          display: \"flex\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: this.state.image ? this.state.image : \"/logo192.png\",\n          alt: \"Logo\",\n          className: \"imagePostLittle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \"image/*\",\n          style: {\n            overflow: \"hidden\",\n            width: \"72px\"\n          },\n          onChange: this.handleFileChange.bind(this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flexDirection: \"column\",\n          display: \"flex\",\n          flex: 1\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"category\",\n          value: this.state.category ? this.state.category._id : null,\n          onChange: this.onChange.bind(this),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: null,\n            children: \" Aucune \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 21\n          }, this), this.state.categories.map((item, index) => {\n            return /*#__PURE__*/_jsxDEV(\"option\", {\n              value: item._id,\n              children: item.title\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 32\n            }, this);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"title\",\n          value: this.state.title,\n          placeholder: \"title\",\n          onChange: this.onChange.bind(this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"title_description\",\n          value: this.state.title_description,\n          placeholder: \"title description\",\n          onChange: this.onChange.bind(this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(RichTextEditor, {\n          style: {\n            flex: 1\n          },\n          name: \"contenu\",\n          onChange: value => this.setState({\n            contenu: value\n          }),\n          value: this.state.contenu\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: this.save.bind(this),\n            children: \"valider\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 21\n          }, this), this.props.data && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: this.delete.bind(this),\n            children: \"supprimer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: this.cancel.bind(this),\n            children: \"annuler\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/zoema/blog/front-react/src/component/FormPost.js"],"names":["React","updateRessource","createRessource","deleteRessource","getRessources","RichTextEditor","FormPost","Component","constructor","props","data","state","Object","assign","image","categories","category","contenu","createValueFromString","title","title_description","createEmptyValue","componentDidMount","then","result","setState","shouldComponentUpdate","nextProps","nextState","onChange","e","target","name","value","handleFileChange","event","files","reader","FileReader","onload","readAsDataURL","save","preventDefault","postData","toString","__v","_id","updated","Date","alert","refresh","onHide","cancel","delete","render","flexDirection","display","padding","flex","overflow","width","bind","map","item","index"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {updateRessource, createRessource, deleteRessource, getRessources } from '../services/api_services';\nimport RichTextEditor from 'react-rte';\n\nexport default class FormPost extends React.Component {\n    constructor(props){\n        super(props);\n        if(props.data){\n            this.state= Object.assign({image:null, categories:[], category:null},\n                                       props.data)\n            this.state.contenu= RichTextEditor.createValueFromString(this.state.contenu, \"html\");\n        }else{\n            this.state={title:\"\", title_description:\"\",  categories:[], category:null,\n                        contenu:RichTextEditor.createEmptyValue(), image:null}\n        }\n    }\n\n    componentDidMount(){\n        getRessources(\"category\").then(result=>{\n            this.setState({categories:result});\n        });\n    }\n\n    shouldComponentUpdate(nextProps, nextState){\n        if(nextProps.data && this.props.data!= nextProps.data){\n            Object.assign(nextState, nextProps.data);\n        }\n        return true;\n    }\n\n    onChange(e){\n        this.setState({[e.target.name]:e.target.value});\n    }\n\n    handleFileChange(event) {\n        const {target} = event;\n        const {files} = target;    \n        if (files && files[0]) {\n            var reader = new FileReader();\n            reader.onload = event => {\n              this.setState({image:event.target.result});\n            };\n            reader.readAsDataURL(files[0]);\n        }\n    }\n\n    save(e){\n        e.preventDefault();\n        let postData = Object.assign({}, this.state);\n        postData.contenu= postData.contenu.toString('html')\n        if(this.props.data){\n            delete postData.__v;\n            delete postData._id;\n            postData.updated= new Date();\n            updateRessource(\"post\", this.props.data._id, postData).then(result=>{\n                alert(\"Enregistrement éffectué.\");\n                this.props.refresh();\n            });\n        }else{\n            createRessource(\"post\", postData).then(result=>{\n                alert(\"Enregistrement éffectué.\");\n                this.props.refresh();\n                this.props.onHide();\n            });\n        }\n    }\n\n    cancel(e){\n        e.preventDefault();\n        this.props.onHide();\n    }\n\n    delete(e){\n        e.preventDefault();\n        deleteRessource(\"post\", this.props.data._id).then(result=>{\n            alert(\"Suppréssion éffectué.\");\n            this.props.refresh();\n            this.props.onHide();\n        });\n    }\n\n    render() {\n      return (\n        <form style={{flexDirection:\"row\", display:\"flex\", padding:10, flex:1}}>\n            <div style={{flexDirection:\"column\", display:\"flex\"}}>\n                <img src={this.state.image ? this.state.image : \"/logo192.png\"}\n                    alt=\"Logo\"  className={\"imagePostLittle\"}/>\n                <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    style={{overflow:\"hidden\",width: \"72px\"}}\n                    onChange={this.handleFileChange.bind(this)}\n                />\n            </div>\n            <div style={{flexDirection:\"column\", display:\"flex\", flex:1}}>\n                <select name=\"category\" value={this.state.category ? this.state.category._id : null}  \n                        onChange={this.onChange.bind(this)}>\n                    <option value={null}> Aucune </option>\n                    {this.state.categories.map((item, index)=>{\n                        return <option key={index} value={item._id}>{item.title}</option>\n                    })}\n                </select>\n                <input name=\"title\" value={this.state.title}\n                    placeholder=\"title\"\n                    onChange={this.onChange.bind(this)}/>\n                <input name=\"title_description\" value={this.state.title_description}\n                    placeholder=\"title description\"\n                    onChange={this.onChange.bind(this)}/>\n                <RichTextEditor style={{flex:1}} name=\"contenu\"\n                    onChange={(value)=>this.setState({contenu:value})}\n                    value={this.state.contenu}\n                />\n                <div>\n                    <button onClick={this.save.bind(this)}>\n                        valider\n                    </button>\n                    {this.props.data&&\n                        <button onClick={this.delete.bind(this)}>\n                            supprimer\n                        </button>\n                    }\n                    <button onClick={this.cancel.bind(this)}>\n                        annuler\n                    </button>\n                </div>\n            </div>\n        </form>\n      );\n    }\n}"]},"metadata":{},"sourceType":"module"}